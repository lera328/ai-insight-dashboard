# Руководство по деплою AI-Insight Dashboard на Vercel

В этом руководстве вы найдете пошаговые инструкции для развертывания приложения AI-Insight Dashboard на платформе [Vercel](https://vercel.com/).

## Содержание

1. [Предварительные требования](#предварительные-требования)
2. [Отправка кода в репозиторий GitHub](#отправка-кода-в-репозиторий-github)
3. [Создание проекта на Vercel](#создание-проекта-на-vercel)
4. [Настройка переменных окружения](#настройка-переменных-окружения)
5. [Деплой через интерфейс Vercel](#деплой-через-интерфейс-vercel)
6. [Деплой через Vercel CLI](#деплой-через-vercel-cli)
7. [Проверка работоспособности](#проверка-работоспособности)
8. [Настройка автоматического деплоя](#настройка-автоматического-деплоя)
9. [Устранение неисправностей](#устранение-неисправностей)

## Предварительные требования

- Учетная запись [GitHub](https://github.com/)
- Учетная запись [Vercel](https://vercel.com/)
- Git, установленный на вашем компьютере
- Vercel CLI (для деплоя через командную строку)

## Отправка кода в репозиторий GitHub

1. Создайте новый репозиторий на GitHub

   Перейдите на [GitHub](https://github.com/) и нажмите "New repository" (или "+" в правом верхнем углу → "New repository").
   
   - **Repository name**: `ai-insight-dashboard` (или другое имя по вашему выбору)
   - **Description**: AI-Insight Dashboard - аналитика текста с использованием искусственного интеллекта
   - Выберите видимость: Public или Private
   - Нажмите "Create repository"

2. Инициализируйте Git в локальном проекте (если еще не сделано)

   ```bash
   cd /путь/к/ai-insight-dashboard
   git init
   ```

3. Добавьте файлы в Git, сделайте коммит и отправьте их в репозиторий

   ```bash
   # Добавить все файлы в индекс
   git add .
   
   # Создать коммит с сообщением
   git commit -m "Первоначальная версия AI-Insight Dashboard"
   
   # Добавить удаленный репозиторий
   git remote add origin https://github.com/ваше-имя/ai-insight-dashboard.git
   
   # Отправить изменения в ветку main
   git push -u origin main
   ```

   > **Примечание**: Если вы используете ветку `master` вместо `main`, замените `main` на `master` в последней команде.

## Создание проекта на Vercel

1. Войдите в свою учетную запись [Vercel](https://vercel.com/)
2. Нажмите кнопку "Add New..." и выберите "Project"
3. В разделе "Import Git Repository" найдите и выберите `ai-insight-dashboard` из списка репозиториев
4. Если вашего репозитория нет в списке, нажмите "Import Third-Party Git Repository →" и введите URL вашего репозитория

## Настройка переменных окружения

1. После выбора репозитория, прокрутите страницу до раздела "Environment Variables"
2. Добавьте следующие переменные (в зависимости от конфигурации вашего проекта):

   **Для локального Ollama**
   - **Ключ**: `OLLAMA_API_URL`
   - **Значение**: URL вашего Ollama API, например, `http://localhost:11434/api`
   
   > **Важно**: Локальный Ollama не будет доступен из облачного окружения Vercel. Для production вам потребуется настроить публично доступный экземпляр Ollama или использовать другой сервис.
   
   **Или для внешнего API (например, OpenAI)**
   - **Ключ**: `AI_API_KEY`
   - **Значение**: Ваш API-ключ
   
   - **Ключ**: `AI_API_URL`
   - **Значение**: URL API, например, `https://api.openai.com/v1`

3. Нажмите "Add" для каждой переменной
4. Для безопасности выберите опцию "Encrypt" для API-ключей

## Деплой через интерфейс Vercel

1. После настройки переменных окружения нажмите кнопку "Deploy"
2. Vercel автоматически определит, что это проект Next.js и настроит соответствующие параметры сборки
3. Дождитесь завершения процесса деплоя (обычно занимает 1-3 минуты)
4. После успешного деплоя вы увидите сообщение "Congratulations!" и ссылку на ваше развернутое приложение

## Деплой через Vercel CLI

Если вы предпочитаете использовать командную строку:

1. Установите Vercel CLI глобально:

   ```bash
   npm install -g vercel
   ```

2. Войдите в свою учетную запись Vercel:

   ```bash
   vercel login
   ```

3. В корне вашего проекта запустите деплой:

   ```bash
   vercel
   ```

4. Следуйте инструкциям:
   - Подтвердите, что это директория проекта
   - Выберите область (scope) вашего проекта
   - Подтвердите имя проекта или укажите новое
   - Подтвердите, что это Next.js проект
   - Укажите, нужно ли переопределить настройки по умолчанию (обычно нет)
   - Настройте переменные окружения, если CLI запросит их

5. Для деплоя в production (а не preview):

   ```bash
   vercel --prod
   ```

## Проверка работоспособности

После успешного деплоя:

1. Перейдите по предоставленной Vercel ссылке на ваше приложение (обычно в формате `https://ai-insight-dashboard-username.vercel.app`)
2. Проверьте основные функции:
   - Работает ли форма ввода текста
   - Генерируются ли инсайты
   - Отображаются ли все элементы интерфейса корректно

3. Проверьте логи деплоя в Vercel Dashboard:
   - Перейдите в раздел "Deployments"
   - Выберите последний деплой
   - Перейдите на вкладку "Logs"
   - Проверьте наличие ошибок или предупреждений

## Настройка автоматического деплоя

Vercel автоматически настраивает Continuous Deployment для вашего проекта:

1. Каждый новый push в основную ветку репозитория вызовет автоматический деплой
2. Для настройки дополнительных опций:
   - Перейдите в настройки проекта в Vercel
   - В разделе "Git" вы можете:
     - Настроить production ветку
     - Изменить команду сборки и выходную директорию
     - Включить или отключить автоматический деплой для определенных веток

## Устранение неисправностей

### Проблема: Сборка не удалась

**Возможные причины и решения:**

1. **Ошибки в коде**
   - Проверьте логи сборки для деталей
   - Исправьте ошибки в коде и отправьте изменения в репозиторий

2. **Проблемы с зависимостями**
   ```bash
   # Локально проверьте сборку
   npm run build
   # Обновите пакеты, если необходимо
   npm update
   ```

3. **Несовместимая версия Node.js**
   - Создайте файл `.nvmrc` в корне проекта с нужной версией Node.js
   ```
   16.x
   ```
   - Или добавьте в package.json:
   ```json
   "engines": {
     "node": ">=16.0.0"
   }
   ```

### Проблема: API не работает после деплоя

1. **Проверьте переменные окружения**:
   - В Vercel Dashboard перейдите в Settings → Environment Variables
   - Убедитесь, что все переменные настроены правильно

2. **CORS-ошибки**:
   - Если вы используете внешнее API, убедитесь, что в вашем Next.js API-маршруте установлены правильные CORS-заголовки

3. **Проблемы с Ollama API**:
   - Как упоминалось ранее, локальный Ollama не будет доступен для облачного Vercel
   - Рассмотрите возможность использования облачных альтернатив, таких как OpenAI API

---

## Дополнительные ресурсы

- [Документация Vercel по Next.js деплою](https://nextjs.org/docs/deployment)
- [Vercel CLI документация](https://vercel.com/docs/cli)
- [Управление переменными окружения в Vercel](https://vercel.com/docs/concepts/projects/environment-variables)

---

Если у вас возникли дополнительные вопросы по деплою, обратитесь к официальной документации Vercel или создайте issue в репозитории проекта.
